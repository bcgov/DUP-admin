# name: Deploy Prod
# TODO look into github environments to handle dev/test/prod AWS vars
# on:
#   workflow_run:
#     workflows:
#       - Tag
#     branches:
#       - "v[0-9].[0-9]+.[0-9]+"
#     types:
#       - completed

# env:
#   TF_VERSION: 0.14.7
#   TG_VERSION: 0.26.7
#   TG_SRC_PATH: terraform
#   TFC_WORKSPACE: prod

# jobs:
#   cd:
#     name: cd
#     runs-on: ubuntu-20.04
#     if: ${{ github.event.workflow_run.conclusion == 'success' }}

#     steps:
#       - name: Check out the repo
#         uses: actions/checkout@v2
#         with:
#           ref: ${{ github.event.workflow_run.head_branch }}

#       - uses: hashicorp/setup-terraform@v1
#         with:
#           terraform_version: ${{ env.TF_VERSION }}
#           cli_config_credentials_token: ${{ secrets.TFC_TEAM_TOKEN }}

#       - uses: peter-murray/terragrunt-github-action@v1.0.0
#         with:
#           terragrunt_version: ${{ env.TG_VERSION }}

#       - name: Terragrunt Apply
#         working-directory: ${{ env.TG_SRC_PATH }}/${{ env.TFC_WORKSPACE }}
#         run: terragrunt apply-all --terragrunt-non-interactive
